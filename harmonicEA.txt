//+------------------------------------------------------------------+
//|                                                       Aneris.mq4 |
//|                        Copyright 2018, MetaQuotes Software Corp. |
//|                                             https://www.mql5.com |
//+------------------------------------------------------------------+
#property copyright "Copyright 2018, MetaQuotes Software Corp."
#property link      "https://www.mql5.com"
#property version   "1.05"
#property strict

extern double loty=0.1;
int Slip;
double UsePoint;
double CalcPoint;
double CalcSlippage;
int miernik=0;
string formacja;
  int kontroler;
  double wskaznikhistorycznyHIGH;
  double wskaznikhistorycznyLOW;
  long current_chart_id=ChartID();
  int LicznikTrojkatow=0;
  datetime datapunktubuy;
  datetime datapunktusell;
  datetime datapoczatku;
  datetime DateNew2;
  datetime DateCurrent2;
  datetime DateNew;
  datetime DateCurrent;
  datetime datakontrolna;
  double HighestHighNew;
  double LowestLowNew;
  double HighestHighCurrent;
  double LowestLowCurrent;
  double cenapunktubuy;
  double cenapunktusell;
  int indexhigh=0;
  int indexlow=0;
  int n;
  datetime trojkat1czas[3];
  datetime trojkat2czas[3];
  double trojkat1cena[3];
  double trojkat2cena[3];
  int licznik;
  int z;
  datetime DateNewHist;
  datetime DateNew2Hist;
  datetime DateCurrentHist;
  datetime DateCurrent2Hist;
  double HighestHighNewHist;
  double HighestHighCurrentHist;
  double LowestLowNewHist;
  double LowestLowCurrentHist;
  int kontrolerhist;
  int pierwszytrojkat=0;
  int poczatek;
  int ostatni;
  double Fibo[5];
   
   int licznikpunktow()
   {
   for (int i=1;i<5000;i++)
   {
   
   wskaznikhistorycznyHIGH=iRSI(NULL,0,14,PRICE_HIGH,i);
   wskaznikhistorycznyLOW=iRSI(NULL,0,14,PRICE_LOW,i);
   if(i>0 && i<2)
   {
   datapoczatku=iTime(Symbol(),0,i);
   }
   
   if (wskaznikhistorycznyHIGH>=70)
   {
   DateNewHist=iTime(Symbol(),0,i);
   HighestHighNewHist=iHigh(Symbol(),0,i);
   if (HighestHighNewHist>HighestHighCurrentHist && DateNewHist<DateCurrentHist)
   {
   HighestHighCurrentHist=HighestHighNewHist;
   DateCurrentHist=DateNewHist;
   kontrolerhist=2;
   LowestLowCurrentHist=0;
   DateCurrent2Hist=datakontrolna;
   continue;
   }
   if (HighestHighNewHist>HighestHighCurrentHist && DateCurrentHist<=datakontrolna)
   {
   HighestHighCurrentHist=HighestHighNewHist;
   DateCurrentHist=DateNewHist;
   kontrolerhist=2;
   LowestLowCurrentHist=0;
   DateCurrent2Hist=datakontrolna;
   continue;
   }
   else if (HighestHighNewHist<=HighestHighCurrentHist)
   {
   continue;
   }
   }
   if (wskaznikhistorycznyLOW<=30)
   {
   DateNew2Hist= iTime(Symbol(),0,i);
   LowestLowNewHist=iLow(Symbol(), 0, i);
   if (LowestLowNewHist<LowestLowCurrentHist && DateNew2Hist<DateCurrent2Hist) 
   {
   LowestLowCurrentHist=LowestLowNewHist;
   DateCurrent2Hist= DateNew2Hist;
         HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
   kontrolerhist=1;
   continue;
   }
   if (LowestLowNewHist>LowestLowCurrentHist && DateCurrent2Hist<=datakontrolna)
   {
   LowestLowCurrentHist=LowestLowNewHist;
   DateCurrent2Hist= DateNew2Hist;
   kontrolerhist=1;
            HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
   continue;
   }
   else if (LowestLowNewHist<=LowestLowCurrentHist)
  {
   continue;

   }
}
  if (wskaznikhistorycznyLOW<70 && wskaznikhistorycznyHIGH>30)
  {
  if(kontrolerhist>1 && HighestHighCurrentHist>0)
   {
   if (z<1)
   {
    cenapunktubuy=HighestHighCurrentHist;
    datapunktubuy=DateCurrentHist;
    z++;
    kontrolerhist=0;
   // Print ("Pobralem punkt buy0 ", HighestHighCurrentHist," ", DateCurrentHist);
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
    ostatni=2;
    continue;
   }
   if (z>0 && z<2)
   {
  if (ostatni>0 && ostatni<2)
  {
  if (cenapunktusell<HighestHighCurrentHist && datapunktusell>DateCurrentHist)
  {
  if (cenapunktusell>0 && datapunktusell>datakontrolna)
  {
   cenapunktubuy=HighestHighCurrentHist;
   datapunktubuy=DateCurrentHist;
   z++;
   kontrolerhist=0;
  // Print ("Pobralem punkt buy1  ", HighestHighCurrentHist," ", DateCurrentHist);
   ostatni=2;
   HighestHighCurrentHist=0;
   DateCurrentHist=datakontrolna;
   LowestLowCurrentHist=0;
   DateCurrent2Hist=datakontrolna;
   continue;
   }
  }
  }
  }
  if (z>1 && z<3)
  {
      if(ostatni>0 && ostatni<2)
      {
      if (HighestHighCurrentHist>cenapunktusell && DateCurrentHist<datapunktusell)
      {
         cenapunktubuy=HighestHighCurrentHist;
         datapunktubuy=DateCurrentHist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt buy2  ", HighestHighCurrentHist," ", DateCurrentHist);
         ostatni=2;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
         continue;
      }
   }
  }
    if (z>2 && z<4)
  {
      if(ostatni>0 && ostatni<2)
   {
      if (HighestHighCurrentHist>cenapunktusell && DateCurrentHist<datapunktusell)
      {
         cenapunktubuy=HighestHighCurrentHist;
         datapunktubuy=DateCurrentHist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt buy3  ", HighestHighCurrentHist," ", DateCurrentHist);
         ostatni=2;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
         continue;
      }
   }
  }
    if (z>3 && z<5)
  {
      if(ostatni>0 && ostatni<2)
   {
      if (HighestHighCurrentHist>cenapunktusell && DateCurrentHist<datapunktusell)
      {
         cenapunktubuy=HighestHighCurrentHist;
         datapunktubuy=DateCurrentHist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt buy4  ", HighestHighCurrentHist," ", DateCurrentHist);
         ostatni=2;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
  continue;
      }
      }
  }
  if (z>4 && z<6)
  {
   if(ostatni>0 && ostatni<2)
   {
      if (HighestHighCurrentHist>cenapunktusell && DateCurrentHist<datapunktusell)
      {
         cenapunktubuy=HighestHighCurrentHist;
         datapunktubuy=DateCurrentHist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt buy5  ", HighestHighCurrentHist," ", DateCurrentHist);
         ostatni=2;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
  int poczatekhist=Bars(NULL, 0, datapunktubuy,datapoczatku);
  poczatek=poczatekhist;
  break;
      }
      }
  }
  }
  if (kontrolerhist<2 &&  kontrolerhist>0)
  {
  if (LowestLowCurrentHist>0.0)
  {
  if (z<1)
  {
  cenapunktusell=LowestLowCurrentHist;
  datapunktusell=DateCurrent2Hist;
  z++;
  kontrolerhist=0;
  //Print ("Pobralem punkt sell0  ", LowestLowCurrentHist," ", DateCurrent2Hist);
  ostatni=1;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
  continue;
  }
   if (z>0 && z<2)
   {
   if (ostatni>1)
   {
   if (cenapunktubuy>LowestLowCurrentHist && datapunktubuy>DateCurrent2Hist)
  {
  if(cenapunktubuy>0 && datapunktubuy>datakontrolna)
    {
   cenapunktusell=LowestLowCurrentHist;
   datapunktusell=DateCurrent2Hist;
   z++;
   kontrolerhist=0;
   //Print ("Pobralem punkt sell1  ", LowestLowCurrentHist," ", DateCurrent2Hist);
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
      ostatni=1;
      continue;
   }
  }
  }
  }
    if (z>1 && z<3)
  {
   if (ostatni>1)
   {
      if (LowestLowCurrentHist<cenapunktubuy && DateCurrent2Hist<datapunktubuy)
      {
         cenapunktusell=LowestLowCurrentHist;
         datapunktusell=DateCurrent2Hist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt sell2  ", LowestLowCurrentHist," ", DateCurrent2Hist);
         ostatni=1;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
         continue;
      }
   }
  }
  if (z>2 && z<4)
  {
   if (ostatni>1)
   {
      if (LowestLowCurrentHist<cenapunktubuy && DateCurrent2Hist<datapunktubuy)
      {
         cenapunktusell=LowestLowCurrentHist;
         datapunktusell=DateCurrent2Hist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt sell3  ", LowestLowCurrentHist," ", DateCurrent2Hist);
         ostatni=1;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
         continue;
      }
   }
  }
  if (z>3 && z<5)
  {
   if (ostatni>1)
   {
      if (LowestLowCurrentHist<cenapunktubuy && DateCurrent2Hist<datapunktubuy)
      {
         cenapunktusell=LowestLowCurrentHist;
         datapunktusell=DateCurrent2Hist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt sell4  ", LowestLowCurrentHist," ", DateCurrent2Hist);
         ostatni=1;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
  continue;
      }
   }
   }
if (z>4 && z<6)
  {
  if (ostatni>1)
   {
      if (LowestLowCurrentHist<cenapunktubuy && DateCurrent2Hist<datapunktubuy)
      {
         cenapunktusell=LowestLowCurrentHist;
         datapunktusell=DateCurrent2Hist;
         z++;
         kontrolerhist=0;
         //Print ("Pobralem punkt sell5  ", LowestLowCurrentHist," ", DateCurrent2Hist);
         ostatni=1;
      HighestHighCurrentHist=0;
    DateCurrentHist=datakontrolna;
               LowestLowCurrentHist=0;
  DateCurrent2Hist=datakontrolna;
  int poczatekhist=Bars(NULL, 0, datapunktusell, datapoczatku);
  poczatek=poczatekhist;
  break;
      }
   }
 }
}
}   
} 
}
  //Print ("Przesuniecie = " , poczatek);
  return(poczatek);
}
   double PipPoint(string Currency)
   {
      int CalcDigits = MarketInfo(Currency,MODE_DIGITS);
      if(CalcDigits == 2 || CalcDigits == 3) CalcPoint = 0.01;
      else if(CalcDigits == 4 || CalcDigits == 5) CalcPoint = 0.0001;
      return(CalcPoint);
   }
   
   int GetSlippage(string Currency, int SlippagePips)
   {
      int CalcDigits = MarketInfo(Currency,MODE_DIGITS);
      if(CalcDigits == 2 || CalcDigits == 3) CalcSlippage = SlippagePips;
      else if(CalcDigits == 4 || CalcDigits == 5) CalcSlippage = SlippagePips * 10;
      return(CalcSlippage);
   }
   
//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
  {
//---
 
//---
   return(INIT_SUCCEEDED);
  }
//+------------------------------------------------------------------+
//| Expert deinitialization function                                 |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
  {
//---
   
  }
//+------------------------------------------------------------------+
//| Expert tick function                                             |
//+------------------------------------------------------------------+
void OnTick()
  {
  Slip = GetSlippage(Symbol(), 10);
  UsePoint = PipPoint(Symbol());
  
  double wskaznikHIGH=iRSI(NULL,0,14,PRICE_HIGH,1);
  double wskaznikLOW=iRSI(NULL,0,14,PRICE_LOW,1);
//---
if (licznik<4)
{
if (wskaznikHIGH<70 && wskaznikLOW>30)
{
for (int i=licznikpunktow();i>=1;i--)
{
wskaznikhistorycznyHIGH=iRSI(NULL,0,14,PRICE_HIGH,i);
wskaznikhistorycznyLOW=iRSI(NULL,0,14,PRICE_LOW,i);
  if (wskaznikhistorycznyHIGH>=70)
   {
   {
   DateNewHist=iTime(Symbol(),0,i);
   HighestHighNewHist=iHigh(Symbol(),0,i);
   }
   if (HighestHighNewHist>HighestHighCurrentHist && DateNewHist>DateCurrentHist)
   {
   HighestHighCurrentHist=HighestHighNewHist;
   DateCurrentHist=DateNewHist;
   kontrolerhist=2;
   LowestLowCurrentHist=0;
   DateCurrent2Hist=datakontrolna;
   continue;
   }
   }
   else if (wskaznikhistorycznyLOW<=30)
   {
   {
   DateNew2Hist= iTime(Symbol(),0,i);
   LowestLowNewHist=iLow(Symbol(), 0, i);
   }
   if (LowestLowNewHist<LowestLowCurrentHist && DateNew2Hist>DateCurrent2Hist) 
   {
   LowestLowCurrentHist=LowestLowNewHist;
   DateCurrent2Hist= DateNew2Hist;
   kontrolerhist=1;
   HighestHighCurrentHist=0;
   HighestHighNewHist=0;
   DateCurrentHist=datakontrolna;
   DateNewHist=datakontrolna;
   }
   else if (LowestLowNewHist>LowestLowCurrentHist && DateCurrent2Hist<=datakontrolna)
   {
   LowestLowCurrentHist=LowestLowNewHist;
   DateCurrent2Hist= DateNew2Hist;
   kontrolerhist=1;
   HighestHighCurrentHist=0;
   HighestHighNewHist=0;
   DateCurrentHist=datakontrolna;
   DateNewHist=datakontrolna;
   continue;   
   }

   }
  if (wskaznikhistorycznyLOW<70 && wskaznikhistorycznyHIGH>30)
  {
  if(kontrolerhist>1 && HighestHighCurrentHist>0.0)
  {
  if (n<1)
  {
   trojkat1cena[0]=HighestHighCurrentHist;
   trojkat1czas[0]=DateCurrentHist;
   n=1;
   kontrolerhist=0;
   ostatni=2;
   //Print ("Pobralem trojkat1[0]HH=", HighestHighCurrentHist," ", DateCurrentHist);
   HighestHighCurrentHist=0.0;
   DateCurrentHist=datakontrolna;
   continue;
  }
  if (n>0 && n<2)
  {
  if (ostatni>1)
  {
  if (trojkat1cena[0]<HighestHighCurrentHist && trojkat1czas[0]<DateCurrentHist)
  {
  if (trojkat1cena[0]>0 && trojkat1czas[0]>datakontrolna)
  {
  trojkat1cena[0]=HighestHighCurrentHist;
  trojkat1czas[0]=DateCurrentHist;
  kontrolerhist=0;
  ostatni=2;
  //Print ("Poprawilem trojkat1[0]HH=", HighestHighCurrentHist," ", DateCurrentHist);
  continue;
  }
  }
  }
  if (ostatni>0 && ostatni<2)
  {
  if (trojkat2cena[1]<HighestHighCurrentHist && trojkat2czas[1]<DateCurrentHist)
  {
  if (trojkat2cena[0]>0.0 && trojkat2czas[0]>datakontrolna)
  {
   trojkat2cena[1]=HighestHighCurrentHist;
   trojkat2czas[1]=DateCurrentHist;
   n=2;
   kontrolerhist=0;
   ostatni=2;
   //Print ("Pobralem trojkat2[1]HH=", HighestHighCurrentHist," ", DateCurrentHist);
   HighestHighCurrentHist=0.0;
   DateCurrentHist=datakontrolna;
   continue;
   }
  }
  }
  }
  if (n>1 && n<3)
  {
  if (ostatni>1)
  {
  if (trojkat2cena[1]<HighestHighCurrentHist && trojkat2czas[1]<DateCurrentHist)
  {
  if (trojkat2czas[1]>datakontrolna)
  {
  trojkat2cena[1]=HighestHighCurrentHist;
  trojkat2czas[1]=DateCurrentHist;
  ostatni=2;
  kontrolerhist=0;
  //Print ("Poprawilem trojkat2[1]HH=", HighestHighCurrentHist," ", DateCurrentHist);
   continue;
   }
  }
  }
  if (ostatni>0 && ostatni<2)
  {
  if (trojkat1cena[1]<HighestHighCurrentHist && trojkat1czas[1]<DateCurrentHist)
  {
  if (trojkat1czas[1]>datakontrolna)
  {
   trojkat1cena[2]=HighestHighCurrentHist;
   trojkat1czas[2]=DateCurrentHist;
   n=3;
   kontrolerhist=0;
        //Print ("Pobralem trojkat1[2]HH=", HighestHighCurrentHist," ", DateCurrentHist);
   HighestHighCurrentHist=0.0;
   DateCurrentHist=datakontrolna;
   licznik=1;
   ostatni=2;
  ObjectCreate(current_chart_id,"Trojkat1", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
  ObjectSetInteger( current_chart_id, "Trojkat1",OBJPROP_COLOR, clrRed);
  Sleep(100);
  continue;
  }
  }
  }
  }
  if (n>2 && n<4)
  {
  if (licznik>0 && licznik<2)
  {
  if (ostatni>0  && ostatni<2)
   {
    if (trojkat2cena[2]<HighestHighCurrentHist && trojkat2czas[2]<DateCurrentHist)
   {
      trojkat1cena[0]=trojkat2cena[1];
      trojkat1czas[0]=trojkat2czas[1];
      trojkat1cena[1]=trojkat2cena[2];
      trojkat1czas[1]=trojkat2czas[2];
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      Sleep(10);
      ObjectCreate(current_chart_id,"Trojkat2", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat2",OBJPROP_COLOR, clrRed);
      Sleep(50);
      licznik=2;
      ostatni=2;
      n++;
      HighestHighCurrentHist=0.0;
      DateCurrentHist=datakontrolna;
      kontrolerhist=0;
      continue;
   }
   }
   if(ostatni>1)
   {
   if (trojkat1cena[2]<HighestHighCurrentHist && trojkat1czas[2]<DateCurrentHist)
   {
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      ObjectDelete(current_chart_id,"Trojkat1");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat1", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat1",OBJPROP_COLOR, clrRed);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem HH tr1[2]","  HH=", HighestHighCurrentHist, "Data=" ,DateCurrentHist);
      ostatni=2;
      kontrolerhist=0;
      continue;
   }
   }
  }
  }
  if (n>3 && n<5)
  {
  if (licznik>1 && licznik<3)
  {
  if (ostatni>1)
  {
    if (trojkat1cena[2]<HighestHighCurrentHist && trojkat1czas[2]<DateCurrentHist)
   {
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      ObjectDelete(current_chart_id,"Trojkat2");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat2", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat2",OBJPROP_COLOR, clrRed);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem HH tr1[2]","  HH=", HighestHighCurrentHist, "Data=" ,DateCurrentHist);
      ostatni=2;
      kontrolerhist=0;
      continue;
   }
  }
   if (ostatni>0 && ostatni<2)
   {
     if (trojkat2cena[2]<HighestHighCurrentHist && trojkat2czas[2]<DateCurrentHist)
   {
      trojkat1cena[0]=trojkat2cena[1];
      trojkat1czas[0]=trojkat2czas[1];
      trojkat1cena[1]=trojkat2cena[2];
      trojkat1czas[1]=trojkat2czas[2];
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      Sleep(10);
      ObjectCreate(current_chart_id,"Trojkat3", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat3",OBJPROP_COLOR, clrRed);
      Sleep(50);
      licznik=3;
      ostatni=2;
      n++;
      HighestHighCurrentHist=0.0;
      DateCurrentHist=datakontrolna;
      kontrolerhist=0;
      continue;
   }
  }
  }
  }
  if (n>4 && n<6)
  {
  if (licznik>2 && licznik<4)
  {
  if (ostatni>1)
  {
    if (trojkat1cena[2]<HighestHighCurrentHist && trojkat1czas[2]<DateCurrentHist)
   {
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      ObjectDelete(current_chart_id,"Trojkat3");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat3", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat3",OBJPROP_COLOR, clrRed);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem HH tr1[2]","  HH=", HighestHighCurrentHist, "Data=" ,DateCurrentHist);
      ostatni=2;
      kontrolerhist=0;
      continue;
   }
  }
   if (ostatni>0 && ostatni<2)
   {
     if (trojkat2cena[2]<HighestHighCurrentHist && trojkat2czas[2]<DateCurrentHist)
   {
      trojkat1cena[0]=trojkat2cena[1];
      trojkat1czas[0]=trojkat2czas[1];
      trojkat1cena[1]=trojkat2cena[2];
      trojkat1czas[1]=trojkat2czas[2];
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      Sleep(10);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrRed);
      //Print ("DataPoczatku=",datapoczatku);
      Sleep(50);
      licznik=4;
      ostatni=2;
      n++;
      HighestHighCurrentHist=0.0;
      DateCurrentHist=datakontrolna;
      kontrolerhist=0;
      continue;
   }
  }
  }
  }
  if (n>5)
  {
  if (licznik>3 && licznik<5)
  {
  if (ostatni>1 && datapoczatku>trojkat1czas[2])
  {
      trojkat1cena[2]=HighestHighCurrentHist;
      trojkat1czas[2]=DateCurrentHist;
      ObjectDelete(current_chart_id,"Trojkat4");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrRed);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem HH tr4[2]","  HH=", HighestHighCurrentHist, "Data=" ,DateCurrentHist);
      ostatni=2;
      kontrolerhist=0;
      continue;
  }
  else continue;
  }
  }
  }
  if (kontrolerhist<2 &&  kontrolerhist>0)
  {
  if (LowestLowCurrentHist>0.0 && DateCurrent2Hist>datakontrolna)
  {
  if (n<1)
  {
   trojkat2cena[0]=LowestLowCurrentHist;
   trojkat2czas[0]=DateCurrent2Hist;
   n=1;
   kontroler=0;
   ostatni=1;
      //Print ("Pobralem trojkat2[0]LL=", LowestLowCurrentHist," ", DateCurrent2Hist);
   LowestLowCurrentHist=0.0;
   DateCurrent2Hist=datakontrolna;
   continue;

  }
  if (n>0 && n<2)
  {
  if (ostatni>0  && ostatni<2)
  {
  if (trojkat2cena[0]>LowestLowCurrentHist && trojkat2czas[0]<DateCurrent2Hist)
  {
  trojkat2cena[0]=LowestLowCurrentHist;
  trojkat2czas[0]=DateCurrent2Hist;
  kontrolerhist=0;
   // Print ("Poprawilem trojkat2[0]LL=", LowestLowCurrentHist," ", DateCurrent2Hist);
    ostatni=1;
     continue;
  }
  }
  if (ostatni>1)
  {
   if (trojkat1cena[0]>LowestLowCurrentHist && trojkat1czas[1]<DateCurrent2Hist)
  {
  if(trojkat1cena[0]>0.0 && trojkat1czas[0]>datakontrolna)
    {
   trojkat1cena[1]=LowestLowCurrentHist;
   trojkat1czas[1]=DateCurrent2Hist;
   n=2;
   kontrolerhist=0;
   //Print ("Pobralem trojkat1[1]LL=", LowestLowCurrentHist," ", DateCurrent2Hist);
      LowestLowCurrentHist=0.0;
      DateCurrent2Hist=datakontrolna;
      ostatni=1;
      continue;

   }
   }
   }
   }
  if (n>1 && n<3)
    {
    if(ostatni>0  && ostatni<2)
    {
  if (trojkat1cena[1]>LowestLowCurrentHist && trojkat1czas[1]<DateCurrent2Hist)
  {
  if (trojkat1czas[1]>datakontrolna)
  {
  trojkat1cena[1]=LowestLowCurrentHist;
  trojkat1czas[1]=DateCurrent2Hist;
  kontrolerhist=0;
  //Print ("Poprawilem trojkat1[1]LL=", LowestLowCurrentHist," ", DateCurrent2Hist);
     ostatni=1;
     continue;
   }
   }
  }
  if (ostatni>1)
  {
  if (trojkat2cena[1]>LowestLowCurrentHist && trojkat2czas[1]<DateCurrent2Hist)
  {
  if (trojkat2czas[1]>datakontrolna)
   {
   trojkat2cena[2]=LowestLowCurrentHist;
   trojkat2czas[2]=DateCurrent2Hist;
   n=3;
   kontrolerhist=0;
   //Print ("Pobralem trojkat2[2]LL=", LowestLowCurrentHist," ", DateCurrent2Hist);
  ObjectCreate(current_chart_id,"Trojkat1", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
  ObjectSetInteger( current_chart_id, "Trojkat1",OBJPROP_COLOR, clrGreen);
  Sleep(100);
  licznik=1;
  pierwszytrojkat=2;
  LowestLowCurrentHist=0.0;
  ostatni=1;
  DateCurrent2Hist=datakontrolna;
  continue;
  }
  }
  }
  }
   if (n>2)
   {
   if (licznik>0 && licznik<2)
   {
   if (ostatni>0  && ostatni<2)
   {
   if (trojkat2cena[2]>LowestLowCurrentHist && trojkat2czas[2]<DateCurrent2Hist)
   {
      if (trojkat2czas[2]>datakontrolna)
   {
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      ObjectDelete(current_chart_id,"Trojkat1");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat1", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat1",OBJPROP_COLOR, clrGreen);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem LL tr2[2]","  LL=", LowestLowCurrentHist, "Data=" ,DateCurrent2Hist);
            ostatni=1;
            continue;
      }
   }
   }
   if (ostatni>1)
   {
   if (trojkat1cena[2]>LowestLowCurrentHist && trojkat1czas[2]<DateCurrent2Hist)
   {
    if (trojkat1czas[2]>datakontrolna)
   {
      trojkat2cena[0]=trojkat1cena[1];
      trojkat2czas[0]=trojkat1czas[1];
      trojkat2cena[1]=trojkat1cena[2];
      trojkat2czas[1]=trojkat1czas[2];
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      Sleep(20);
      ObjectCreate(current_chart_id,"Trojkat2", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat2",OBJPROP_COLOR, clrGreen);
      Sleep(50);
            LowestLowCurrentHist=0.0;
            DateCurrent2Hist=datakontrolna;
            ostatni=1;
            n++;
      licznik=2;
      continue;
      }
   }
  }
  }
  }
  if (n>3 && n<5)
  {
  if (licznik>1 && licznik<3)
  {
  if (ostatni>1)
  {
   if (trojkat1cena[2]>LowestLowCurrentHist && trojkat1czas[2]<DateCurrent2Hist)
   {
    if (trojkat1czas[2]>datakontrolna)
   {
      trojkat2cena[0]=trojkat1cena[1];
      trojkat2czas[0]=trojkat1czas[1];
      trojkat2cena[1]=trojkat1cena[2];
      trojkat2czas[1]=trojkat1czas[2];
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      Sleep(20);
      ObjectCreate(current_chart_id,"Trojkat3", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat3",OBJPROP_COLOR, clrGreen);
      Sleep(50);
            LowestLowCurrentHist=0.0;
            DateCurrent2Hist=datakontrolna;
            ostatni=1;
            n++;
      licznik=3;
      continue;
      }
   }
  }
  if (ostatni>0  && ostatni<2)
   {
   if (trojkat2cena[2]>LowestLowCurrentHist && trojkat2czas[2]<DateCurrent2Hist)
   {
      if (trojkat2czas[2]>datakontrolna)
   {
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      ObjectDelete(current_chart_id,"Trojkat2");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat2", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat2",OBJPROP_COLOR, clrGreen);
      Sleep(50);
     // Print ("Poprawilem trojkat i zmienilem LL tr2[2]","  LL=", LowestLowCurrentHist, "Data=" ,DateCurrent2Hist);
            ostatni=1;
            continue;
      }
   }
   }
  }
}  
if (n>4 && n<6)
  {
  if (licznik>2 && licznik<4)
  {
  if (ostatni>1)
  {
   if (trojkat1cena[2]>LowestLowCurrentHist && trojkat1czas[2]<DateCurrent2Hist)
   {
    if (trojkat1czas[2]>datakontrolna)
   {
      trojkat2cena[0]=trojkat1cena[1];
      trojkat2czas[0]=trojkat1czas[1];
      trojkat2cena[1]=trojkat1cena[2];
      trojkat2czas[1]=trojkat1czas[2];
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      Sleep(20);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrGreen);
     // Print ("DataPoczatku=", datapoczatku);
      Sleep(50);
            LowestLowCurrentHist=0.0;
            DateCurrent2Hist=datakontrolna;
            ostatni=1;
            n++;
      licznik=4;
      continue;
      }
   }
  }
  if (ostatni>0  && ostatni<2)
   {
   if (trojkat2cena[2]>LowestLowCurrentHist && trojkat2czas[2]<DateCurrent2Hist)
   {
      if (trojkat2czas[2]>datakontrolna)
   {
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      ObjectDelete(current_chart_id,"Trojkat3");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat3", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat3",OBJPROP_COLOR, clrGreen);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem LL tr3[2]","  LL=", LowestLowCurrentHist, "Data=" ,DateCurrent2Hist);
            ostatni=1;
            continue;
      }
   }
   }
  }
}
 if (n>5)
  {
  if (licznik>3 && licznik<5)
  {
  if (ostatni>0 && ostatni<2)
  {
  if (datapoczatku>trojkat2czas[2])
  {
      trojkat2cena[2]=LowestLowCurrentHist;
      trojkat2czas[2]=DateCurrent2Hist;
      kontrolerhist=0;
      ObjectDelete(current_chart_id,"Trojkat4");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrGreen);
      Sleep(50);
      //Print ("Poprawilem trojkat i zmienilem LL tr4[2]","  LL=", LowestLowCurrentHist, "Data=" ,DateCurrent2Hist);
            ostatni=1;
            continue;
  }
  else continue;
  }
  }
  } 
  }
  }
}
}
}
if (licznik<4)
{
ObjectDelete(current_chart_id,"Trojkat1");
   ObjectDelete(current_chart_id,"Trojkat2");
   ObjectDelete(current_chart_id,"Trojkat3");
   ObjectDelete(current_chart_id,"Trojkat4");
   ObjectDelete(current_chart_id,"Trojkat5");
   Sleep(50);
   licznik=0;
   kontroler=0;
   wskaznikHIGH=0;
   wskaznikLOW=0;
   wskaznikhistorycznyHIGH=0;
   wskaznikhistorycznyLOW=0;
   LicznikTrojkatow=0;
   datapunktubuy=datakontrolna;
   datapunktusell=datakontrolna;
 datapoczatku=datakontrolna;
 DateNew2=datakontrolna;
 DateCurrent2=datakontrolna;
 DateNew=datakontrolna;
 DateCurrent=datakontrolna;
HighestHighNew=0;
LowestLowNew=0;
 HighestHighCurrent=0;
LowestLowCurrent=0;
cenapunktubuy=0;
cenapunktusell=0;
indexhigh=0;
indexlow=0;
n=0;
trojkat1czas[0]=datakontrolna;
trojkat1czas[1]=datakontrolna;
trojkat1czas[2]=datakontrolna;
trojkat2czas[0]=datakontrolna;
trojkat2czas[1]=datakontrolna;
trojkat2czas[2]=datakontrolna;
trojkat1cena[0]=0;
trojkat1cena[1]=0;
trojkat1cena[2]=0;
trojkat2cena[0]=0;
trojkat2cena[1]=0;
trojkat2cena[2]=0;
z=0;
DateNewHist=datakontrolna;
DateNew2Hist=datakontrolna;
DateCurrentHist=datakontrolna;
DateCurrent2Hist=datakontrolna;
HighestHighNewHist=0;
HighestHighCurrentHist=0;
LowestLowNewHist=0;
LowestLowCurrentHist=0;
kontrolerhist=0;
pierwszytrojkat=0;
poczatek=0;
ostatni=0;
Fibo[0]=0;
Fibo[1]=0;
Fibo[2]=0;
Fibo[3]=0;
Fibo[4]=0;
RefreshRates();
}
if (licznik >=4 && licznik <5)
{
licznik=5;
}
}
if (licznik>4 && licznik<6 )
{
 if (wskaznikHIGH>= 70)
   {
   {
   DateNew=iTime(Symbol(),0,1);
   HighestHighNew=iHigh(Symbol(),0,1);
   kontroler=2;
   LowestLowCurrent=0.0;
   DateCurrent2=datakontrolna;
   }
   if (HighestHighNew>HighestHighCurrent && DateNew>DateCurrent)
   {
   HighestHighCurrent=HighestHighNew;
   DateCurrent=DateNew;
   kontroler=2;
   LowestLowCurrent=0.0;
   DateCurrent2=datakontrolna;
   }
   }
   else if (wskaznikLOW<=30)
   {
   {
   DateNew2= iTime(Symbol(),0,1);
   LowestLowNew=iLow(Symbol(), 0, 1);
   kontroler=1;
   HighestHighCurrent=0.0;
   DateCurrent=datakontrolna;
   }
   if (LowestLowNew<LowestLowCurrent && DateNew2>DateCurrent2) 
   {
   LowestLowCurrent=LowestLowNew;
   DateCurrent2= DateNew2;
   kontroler=1;
   HighestHighCurrent=0.0;
   DateCurrent=datakontrolna;
   }
   else if (LowestLowNew>LowestLowCurrent && LowestLowCurrent<=0.0)
   {
   LowestLowCurrent=LowestLowNew;
   DateCurrent2= DateNew2;
   kontroler=1;
   HighestHighCurrent=0.0;
   DateCurrent=datakontrolna;
   }
   }
  if (wskaznikLOW<70 && wskaznikHIGH>30)
  {
  if(kontroler>1 && HighestHighCurrent>0.0)
  {
   if (trojkat1czas[2]>trojkat2czas[2] && DateCurrent>trojkat1czas[2])
   {
      trojkat1czas[2]=DateCurrent;
      trojkat1cena[2]=HighestHighCurrent;
      ObjectDelete(current_chart_id, "Trojkat4");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrRed);
      Sleep(50);
      HighestHighCurrent=0.0;
      DateCurrent=datakontrolna;
      licznik=6;
   }
   if (trojkat2czas[2]>trojkat1czas[2] && DateCurrent>trojkat2czas[2])
   {
      trojkat1czas[0]=trojkat2czas[1];
      trojkat1cena[0]=trojkat2cena[1];
      trojkat1czas[1]=trojkat2czas[2];
      trojkat1cena[1]=trojkat2cena[2];
      trojkat1czas[2]=DateCurrent;
      trojkat1cena[2]=HighestHighCurrent;
      ObjectCreate(current_chart_id,"Trojkat5", OBJ_TRIANGLE,0,trojkat1czas[0],trojkat1cena[0],trojkat1czas[1],trojkat1cena[1],trojkat1czas[2],trojkat1cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat5",OBJPROP_COLOR, clrRed);
      Sleep(50);
      HighestHighCurrent=0.0;
      DateCurrent=datakontrolna;
      licznik=7;
   }
  }
  if (kontroler <2 && kontroler >0)
  {
  if (LowestLowCurrent>0.0)
  {
  if (trojkat1czas[2]>trojkat2czas[2] && DateCurrent2>trojkat1czas[2])
  {
      trojkat2czas[0]=trojkat1czas[1];
      trojkat2cena[0]=trojkat1cena[1];
      trojkat2czas[1]=trojkat1czas[2];
      trojkat2cena[1]=trojkat1cena[2];
      trojkat2czas[2]=DateCurrent2;
      trojkat2cena[2]=LowestLowCurrent;
      ObjectCreate(current_chart_id,"Trojkat5", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat5",OBJPROP_COLOR, clrGreen);
      Sleep(50);
      HighestHighCurrent=0.0;
      DateCurrent=datakontrolna;
      licznik=7;
  }
  if (trojkat2czas[2]>trojkat1czas[2] && DateCurrent2>trojkat2czas[2])
  {
      trojkat2czas[2]=DateCurrent2;
      trojkat2cena[2]=LowestLowCurrent;
      ObjectDelete(current_chart_id, "Trojkat4");
      Sleep(50);
      ObjectCreate(current_chart_id,"Trojkat4", OBJ_TRIANGLE,0,trojkat2czas[0],trojkat2cena[0],trojkat2czas[1],trojkat2cena[1],trojkat2czas[2],trojkat2cena[2]);
      ObjectSetInteger( current_chart_id, "Trojkat4",OBJPROP_COLOR, clrGreen);
      Sleep(50);
      licznik=6;
      HighestHighCurrent=0.0;
      DateCurrent=datakontrolna;
  }
  }
  }
}  
  }
  if (licznik>5 && licznik<7)
  {
   if (kontroler>1)
   {
      Fibo[0]=(ObjectGet("Trojkat2",OBJPROP_PRICE3)-ObjectGet("Trojkat2",OBJPROP_PRICE2))/((ObjectGet("Trojkat2",OBJPROP_PRICE1)-ObjectGet("Trojkat2",OBJPROP_PRICE2)) / 100);
      Fibo[1]=(ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE3))/((ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE1)) / 100);
      Fibo[2]=(ObjectGet("Trojkat4",OBJPROP_PRICE3)-ObjectGet("Trojkat4",OBJPROP_PRICE2))/((ObjectGet("Trojkat4",OBJPROP_PRICE1)-ObjectGet("Trojkat4",OBJPROP_PRICE2)) / 100);
      Fibo[3]=(ObjectGet("Trojkat4",OBJPROP_PRICE3)-ObjectGet("Trojkat2",OBJPROP_PRICE2))/((ObjectGet("Trojkat2",OBJPROP_PRICE1)-ObjectGet("Trojkat2",OBJPROP_PRICE2)) / 100);
      Fibo[4]=(ObjectGet("Trojkat4",OBJPROP_PRICE3)-ObjectGet("Trojkat4",OBJPROP_PRICE2))/((ObjectGet("Trojkat2",OBJPROP_PRICE1)-ObjectGet("Trojkat4",OBJPROP_PRICE2)) / 100);
      Print("XAB=", Fibo[0],", ABC=", Fibo[1],", BCD=", Fibo[2],", XAD=", Fibo[3], ", XCD=", Fibo[4]);
      licznik=8;
  }
  else if (kontroler>0 && kontroler<2)
  {
      Fibo[0]=(ObjectGet("Trojkat2",OBJPROP_PRICE2)-ObjectGet("Trojkat2",OBJPROP_PRICE3))/((ObjectGet("Trojkat2",OBJPROP_PRICE2)-ObjectGet("Trojkat2",OBJPROP_PRICE1)) /100);
      Fibo[1]=(ObjectGet("Trojkat3",OBJPROP_PRICE3)-ObjectGet("Trojkat3",OBJPROP_PRICE2))/((ObjectGet("Trojkat3",OBJPROP_PRICE1)-ObjectGet("Trojkat3",OBJPROP_PRICE2)) /100);
      Fibo[2]=(ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE3))/((ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE1)) /100);
      Fibo[3]=(ObjectGet("Trojkat2",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE3))/((ObjectGet("Trojkat2",OBJPROP_PRICE2)-ObjectGet("Trojkat2",OBJPROP_PRICE1)) /100);
      Fibo[4]=(ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE3))/((ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat2",OBJPROP_PRICE1)) /100);
      Print("XAB=", Fibo[0],", ABC=", Fibo[1],", BCD=", Fibo[2],", XAD=", Fibo[3], ", XCD=", Fibo[4]);
      licznik=8;
  }
  RefreshRates();
  return;
  }
  if (licznik>6 && licznik<8)
  {
  if (kontroler>1)
  {
      Fibo[0]=(ObjectGet("Trojkat3",OBJPROP_PRICE3)-ObjectGet("Trojkat3",OBJPROP_PRICE2))/((ObjectGet("Trojkat3",OBJPROP_PRICE1)-ObjectGet("Trojkat3",OBJPROP_PRICE2)) / 100);
      Fibo[1]=(ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE3))/((ObjectGet("Trojkat4",OBJPROP_PRICE2)-ObjectGet("Trojkat4",OBJPROP_PRICE1)) / 100);
      Fibo[2]=(ObjectGet("Trojkat5",OBJPROP_PRICE3)-ObjectGet("Trojkat5",OBJPROP_PRICE2))/((ObjectGet("Trojkat5",OBJPROP_PRICE1)-ObjectGet("Trojkat5",OBJPROP_PRICE2)) / 100);
      Fibo[3]=(ObjectGet("Trojkat5",OBJPROP_PRICE3)-ObjectGet("Trojkat3",OBJPROP_PRICE2))/((ObjectGet("Trojkat3",OBJPROP_PRICE1)-ObjectGet("Trojkat3",OBJPROP_PRICE2)) / 100);
      Fibo[4]=(ObjectGet("Trojkat5",OBJPROP_PRICE3)-ObjectGet("Trojkat5",OBJPROP_PRICE2))/((ObjectGet("Trojkat3",OBJPROP_PRICE1)-ObjectGet("Trojkat5",OBJPROP_PRICE2)) / 100);
      Print("XAB=", Fibo[0],", ABC=", Fibo[1],", BCD=", Fibo[2],", XAD=", Fibo[3], ", XCD=", Fibo[4]);
      licznik=8;
  }
   else if (kontroler>0 && kontroler<2)
  {
      Fibo[0]=(ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE3))/((ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE1)) / 100);
      Fibo[1]=(ObjectGet("Trojkat4",OBJPROP_PRICE3)-ObjectGet("Trojkat4",OBJPROP_PRICE2))/((ObjectGet("Trojkat4",OBJPROP_PRICE1)-ObjectGet("Trojkat4",OBJPROP_PRICE2)) / 100);
      Fibo[2]=(ObjectGet("Trojkat5",OBJPROP_PRICE2)-ObjectGet("Trojkat5",OBJPROP_PRICE3))/((ObjectGet("Trojkat5",OBJPROP_PRICE2)-ObjectGet("Trojkat5",OBJPROP_PRICE1)) / 100);
      Fibo[3]=(ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat5",OBJPROP_PRICE3))/((ObjectGet("Trojkat3",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE1)) / 100);
      Fibo[4]=(ObjectGet("Trojkat5",OBJPROP_PRICE2)-ObjectGet("Trojkat5",OBJPROP_PRICE3))/((ObjectGet("Trojkat5",OBJPROP_PRICE2)-ObjectGet("Trojkat3",OBJPROP_PRICE1)) / 100);
      Print("XAB=", Fibo[0],", ABC=", Fibo[1],", BCD=", Fibo[2],", XAD=", Fibo[3], ", XCD=", Fibo[4]);
      licznik=8;
  }
  RefreshRates();
  return;
  }
  if (licznik>7 && licznik<9)
  {
  Print ("przeszed³em do kroku szukania formacji");
  if(Fibo[0]>=36 && Fibo[0]<=52)
  {
   if(Fibo[1]>=36 && Fibo[1]<=90)
   {
      if(Fibo[2]>=160 && Fibo[2]<=265)
      {
         if(Fibo[3]>=85 && Fibo[3]<=90)
         {
         Print ("Brawo, Formacja BAT");
         licznik=9;
         miernik=1;
         formacja="BAT";
         return;
         }
         else if (Fibo[3]<85 || Fibo[3]>90)
         {
         miernik=0;
         }
      }
      else if (Fibo[2]<160 || Fibo[3]>265)
      {
      miernik=0;
      }
   }
   else if (Fibo[1]<36 || Fibo[3]>90)
      {
      miernik=0;
      }
  }
  else if (Fibo[0]<36 || Fibo[3]>52)
      {
      miernik=0;
      }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
   if(Fibo[1]>=36 && Fibo[1]<=90)
   {
      if(Fibo[2]>=124 && Fibo[2]<=265)
      {
         if(Fibo[3]>=85 && Fibo[3]<=90)
         {
         Print ("Brawo, Formacja MAX BAT");
         licznik=9;
         miernik=1;
         formacja="MAX BAT";
         return;
         }
         else if (Fibo[3]<85 || Fibo[3]>90)
      {
      miernik=0;
      }
      }
      else if (Fibo[2]<124 || Fibo[2]>265)
      {
      miernik=0;
      }
   }
   else if (Fibo[1]<36 || Fibo[1]>90)
      {
      miernik=0;
      }
  }
  else if (Fibo[0]<36 || Fibo[0]>65)
      {
      miernik=0;
      }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
   if(Fibo[1]>=36 && Fibo[1]<=90)
   {
      if(Fibo[2]>=111 && Fibo[2]<=225)
      {
         if(Fibo[3]>=60 && Fibo[3]<=80)
         {
         Print ("Brawo, Formacja MAX GARTLEY");
         licznik=9;
         miernik=1;
         formacja="MAX GARTLEY";
         return;
         }
         else if (Fibo[3]<60 || Fibo[3]>80)
      {
      miernik=0;
      }
      }
      else if (Fibo[2]<111 || Fibo[2]>225)
      {
      miernik=0;
      }
   }
   else if (Fibo[1]<36 || Fibo[1]>90)
      {
      miernik=0;
      }
  }
  else if (Fibo[0]<36 || Fibo[0]>65)
      {
      miernik=0;
      }
  if(Fibo[0]>=42 && Fibo[0]<=65)
  {
  if(Fibo[1]>=60 && Fibo[1]<=90)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[3]>=85 && Fibo[3]<=90)
  {
  Print ("Brawo, Formacja ALT SHARK 2");
  licznik=9;
  miernik=1;
  formacja="ALT SHARK 2";
  return;
  }
  else if (Fibo[3]<85 || Fibo[3]>90)
      {
      miernik=0;
      }
  }
  else if (Fibo[2]<160 || Fibo[2]>265)
      {
      miernik=0;
      }
  }
  else if (Fibo[1]<60 || Fibo[1]>90)
      {
      miernik=0;
      }
  }
  else if (Fibo[0]<42 || Fibo[0]>65)
      {
      miernik=0;
      }
  if(Fibo[0]>=47 && Fibo[0]<=80)
  {
  if(Fibo[1]>=45 && Fibo[1]<=72)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[3]>=75 && Fibo[3]<=80)
  {
  Print ("Brawo, Formacja ANTI NEN STAR");
  licznik=9;
  miernik=1;
  formacja="ANTI NEN STAR";
  return;
  }
  else if (Fibo[3]<75 || Fibo[3]>80)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<45 || Fibo[1]>72)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<47 || Fibo[0]>80)
  {
  miernik=0;
  }
  if(Fibo[0]>=47 && Fibo[0]<=53)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=111 && Fibo[2]<=265)
  {
  if(Fibo[3]>=75 && Fibo[3]<=80)
  {
  Print ("Brawo, Formacja LEONARDO");
  licznik=9;
  formacja="Formacja LEONARDO";
  miernik=1;
  return;
  }
   else if (Fibo[3]<75 || Fibo[3]>80)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<111 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<47 || Fibo[0]>53)
  {
  miernik=0;
  }
  if(Fibo[0]>=60 && Fibo[0]<=65)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=124 && Fibo[2]<=165)
  {
  if(Fibo[3]>=75 && Fibo[3]<=80)
  {
  Print ("Brawo, Formacja GARTLEY");
  licznik=9;
  miernik=1;
  formacja="GARTLEY";
  return;
  }
   else if (Fibo[3]<75 || Fibo[3]>80)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<60 || Fibo[1]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=222 && Fibo[2]<=365)
  {
  if(Fibo[3]>=160 && Fibo[3]<=165)
  {
  Print ("Brawo, Formacja CRAB");
  licznik=9;
  miernik=1;
  formacja="CRAB";
  return;
  }
   else if (Fibo[3]<160 || Fibo[3]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<222 || Fibo[2]>365)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=46 && Fibo[0]<=80)
  {
  if(Fibo[1]>=43 && Fibo[1]<=73)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[3]>=124 && Fibo[3]<=130)
  {
  Print ("Brawo, Formacja ANTI NEW CYPHER");
  licznik=9;
  miernik=1;
  formacja="ANTI NEW CYPHER";
  return;
  }
   else if (Fibo[3]<124 || Fibo[3]>130)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<43 || Fibo[1]>73)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<46 || Fibo[0]>80)
  {
  miernik=0;
  }
  if(Fibo[0]>=76 && Fibo[0]<=80)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[3]>=124 && Fibo[3]<=165)
  {
  Print ("Brawo, Formacja BUTTERFLY");
  formacja="BUTTERFLY";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[3]<124 || Fibo[3]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<76 || Fibo[0]>80)
  {
  miernik=0;
  }
  if(Fibo[0]>=60 && Fibo[0]<=90)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=124 && Fibo[2]<=265)
  {
  if(Fibo[3]>=124 && Fibo[3]<=165)
  {
  Print ("Brawo, Formacja MAX BUTTERFLY");
  licznik=9;
  miernik=1;
  formacja="MAX BUTTERFLY";
  return;
  }
   else if (Fibo[3]<124 || Fibo[3]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<60 || Fibo[0]>90)
  {
  miernik=0;
  }
  if(Fibo[0]>=76 && Fibo[0]<=110)
  {
  if(Fibo[1]>=60 && Fibo[1]<=110)
  {
  if(Fibo[2]>=110 && Fibo[2]<=165)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>=110 && Fibo[3]<=120)
  {
  Print ("Brawo, Formacja BUTTERFLY 113");
  licznik=9;
  miernik=1;
  formacja="BUTTERFLY 113";
  return;
  }
   else if (Fibo[3]<110 || Fibo[3]>120)
  {
  miernik=0;
  }
  }
  if (Fibo[4]>=Fibo[3])
  {
  if(Fibo[4]>=110 && Fibo[4]<=120)
  {
  Print ("Brawo, Formacja BUTTERFLY 113");
  licznik=9;
  formacja="BUTTERFLY 113";
  miernik=1;
  return;
  }
   else if (Fibo[4]<110 || Fibo[4]>120)
  {
  miernik=0;
  }
  }
  }
   else if (Fibo[2]<110 || Fibo[2]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<60 || Fibo[1]>110)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<76 || Fibo[0]>110)
  {
  miernik=0;
  }
  if(Fibo[0]>=44 && Fibo[0]<=65)
  {
  if(Fibo[1]>=60 && Fibo[1]<=90)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[3]>=110 && Fibo[3]<=120)
  {
  Print ("Brawo, Formacja ALT SHARK 1");
  licznik=9;
  miernik=1;
  formacja="ALT SHARK 1";
  return;
  }
   else if (Fibo[3]<110 || Fibo[3]>120)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<60 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<44 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=84 && Fibo[0]<=90)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=260 && Fibo[2]<=365)
  {
  if(Fibo[3]>=160 && Fibo[3]<=165)
  {
  Print ("Brawo, Formacja DEEP CRAB");
  licznik=9;
  miernik=1;
  formacja="DEEP CRAB";
  return;
  }
   else if (Fibo[3]<160 || Fibo[3]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<260 || Fibo[2]>365)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<84 || Fibo[0]>90)
  {
  miernik=0;
  }
  if(Fibo[0]>=24 && Fibo[0]<=47)
  {
  if(Fibo[1]>=110 && Fibo[1]<=265)
  {
  if(Fibo[2]>=160 && Fibo[2]<=265)
  {
  if(Fibo[4]>=60 && Fibo[4]<=65)
  {
  Print ("Brawo, Formacja A CRAB");
  licznik=9;
  miernik=1;
  formacja="A CRAB";
  return;
  }
   else if (Fibo[4]<60 || Fibo[4]>65)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<110 || Fibo[1]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<24 || Fibo[0]>47)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=139 && Fibo[1]<=220)
  {
  if(Fibo[2]>=124 && Fibo[2]<=210)
  {
  if(Fibo[4]>=75 && Fibo[4]<=80)
  {
  Print ("Brawo, Formacja NEW CYPHER");
  licznik=9;
  formacja="NEW CYPHER";
  miernik=1;
  return;
  }
   else if (Fibo[4]<75 || Fibo[4]>80)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>210)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<139 || Fibo[1]>220)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=110 && Fibo[1]<=265)
  {
  if(Fibo[2]>=124 && Fibo[2]<=130)
  {
  if(Fibo[4]>=60 && Fibo[4]<=80)
  {
  Print ("Brawo, Formacja A BUTTERFLY");
  licznik=9;
  formacja="A BUTTERFLY";
  miernik=1;
  return;
  }
   else if (Fibo[4]<60 || Fibo[4]>80)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>130)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<110 || Fibo[1]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=100 && Fibo[1]<=165)
  {
  if(Fibo[2]>=160 && Fibo[2]<=240)
  {
  if(Fibo[4]>=85 && Fibo[4]<=90)
  {
  Print ("Brawo, Formacja SHARK 1");
  licznik=9;
  miernik=1;
  formacja="SHARK 1";
  return;
  }
   else if (Fibo[4]<85 || Fibo[3]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>240)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<100 || Fibo[1]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=100 && Fibo[1]<=265)
  {
  if(Fibo[2]>=190 && Fibo[2]<=265)
  {
  if(Fibo[4]>=110 && Fibo[4]<=130)
  {
  Print ("Brawo, Formacja A BAT");
  formacja="A BAT";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[4]<110 || Fibo[4]>130)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<190 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<100 || Fibo[1]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=100 && Fibo[1]<=165)
  {
  if(Fibo[2]>=160 && Fibo[2]<=245)
  {
  if(Fibo[4]>=110 && Fibo[4]<=130)
  {
  Print ("Brawo, Formacja SHARK 2");
  formacja="SHARK 2";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[4]<110 || Fibo[4]>130)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<160 || Fibo[2]>245)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<100 || Fibo[1]>165)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=124 && Fibo[2]<=265)
  {
  if(Fibo[3]>=85 && Fibo[3]<=90)
  {
  Print ("Brawo, Formacja MAX BAT");
  formacja="MAX BAT";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[3]<85 || Fibo[3]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>265)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=65)
  {
  if(Fibo[1]>=130 && Fibo[1]<=230)
  {
  if(Fibo[2]>=124 && Fibo[2]<=210)
  {
  if(Fibo[4]>=110 && Fibo[4]<=140)
  {
  Print ("Brawo, Formacja NEN STAR");
  formacja="NEN STAR";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[4]<110 || Fibo[3]>140)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<124 || Fibo[2]>210)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<130 || Fibo[1]>230)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>65)
  {
  miernik=0;
  }
  if(Fibo[0]>=36 && Fibo[0]<=44)
  {
  if(Fibo[1]>=36 && Fibo[1]<=90)
  {
  if(Fibo[2]>=190 && Fibo[2]<=365)
  {
  if(Fibo[3]>=110 && Fibo[3]<=130)
  {
  Print ("Brawo, Formacja ALT BAT");
  formacja="ALT BAT";
  licznik=9;
  miernik=1;
  return;
  }
   else if (Fibo[3]<110 || Fibo[3]>130)
  {
  miernik=0;
  }
  }
   else if (Fibo[2]<190 || Fibo[2]>365)
  {
  miernik=0;
  }
  }
   else if (Fibo[1]<36 || Fibo[1]>90)
  {
  miernik=0;
  }
  }
   else if (Fibo[0]<36 || Fibo[0]>44)
  {
  miernik=0;
  }
  /*if(Fibo[0]>=36 && Fibo[0]<=80)
  {
  if(Fibo[1]>=85 && Fibo[1]<=120)
  {
  if(Fibo[2]>=85 && Fibo[2]<=365)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>85 && Fibo[3]<130)
  {
  Print ("Brawo, Formacja NAVARRO 200");
  formacja="NAVARRO 200";
  licznik=9;
  miernik=1;
  return;
  }
  }
   if(Fibo[4]>=Fibo[3])
  {
  if(Fibo[4]>85 && Fibo[4]<130)
  {
  Print ("Brawo, Formacja NAVARRO 200");
  formacja="NAVARRO 200";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  }*/
  if(Fibo[0]>60 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[4]>120 && Fibo[4]<140)
  {
  Print ("Brawo, Formacja A GARTLEY");
  formacja="A GARTLEY";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  /*if(Fibo[0]>47 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<365)
  {
  if(Fibo[2]>36 && Fibo[2]<80)
  {
  if(Fibo[4]>36 && Fibo[4]<80)
  {
  Print ("Brawo, Formacja 121");
  formacja="121";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }*/
  if(Fibo[0]>60 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[4]>120 && Fibo[4]<140)
  {
  Print ("Brawo, Formacja A GARTLEY");
  formacja="A GARTLEY";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>190 && Fibo[1]<440)
  {
  if(Fibo[2]>46 && Fibo[2]<90)
  {
  if(Fibo[4]>20 && Fibo[4]<90)
  {
  Print ("Brawo, Formacja BLACK SWAN");
  formacja="BLACK SWAN";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>60 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<165)
  {
  if(Fibo[2]>60 && Fibo[2]<80)
  {
  if(Fibo[4]>10 && Fibo[4]<90)
  {
  Print ("Brawo, Formacja A 3 DRIVES");
  formacja="A 3 DRIVES";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  /*if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>110 && Fibo[1]<165)
  {
  if(Fibo[2]>160 && Fibo[2]<240)
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2");
  formacja="PARTIZAN 2";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>120 && Fibo[0]<210)
  {
  if(Fibo[1]>46 && Fibo[1]<80)
  {
  if(Fibo[2]>120 && Fibo[2]<210)
  {
  if(Fibo[3]>120 && Fibo[3]<265)
  {
  Print ("Brawo, Formacja A 121");
  formacja="A 121";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }*/
  if(Fibo[0]>120 && Fibo[0]<165)
  {
  if(Fibo[1]>60 && Fibo[1]<80)
  {
  if(Fibo[2]>120 && Fibo[2]<165)
  {
  if(Fibo[3]>160 && Fibo[3]<265)
  {
  Print ("Brawo, Formacja 3 DRIVES");
  formacja="3 DRIVES";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>130 && Fibo[0]<260)
  {
  if(Fibo[1]>20 && Fibo[1]<50)
  {
  if(Fibo[2]>110 && Fibo[2]<210)
  {
  if(Fibo[3]>110 && Fibo[3]<265)
  {
  Print ("Brawo, Formacja WHITE SWAN");
  licznik=9;
  formacja="WHITE SWAN";
  miernik=1;
  return;
  }
  }
  }
  }
  /*if(Fibo[0]>10 && Fibo[0]<210)
  {
  if(Fibo[1]>40 && Fibo[1]<65)
  {
  if(Fibo[2]>60 && Fibo[2]<90)
  {
  if(Fibo[3]>60 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja HENRY-DAVID");
  licznik=9;
  formacja="HENRY-DAVID";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<265)
  {
  if(Fibo[1]>20 && Fibo[1]<55)
  {
  if(Fibo[2]>110 && Fibo[2]<210)
  {
  if(Fibo[3]>110 && Fibo[3]<265)
  {
  Print ("Brawo, Formacja STRONG HENRY-DAVID");
  licznik=9;
  formacja="STRONG HENRY-DAVID";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>110 && Fibo[0]<165)
  {
  if(Fibo[1]>160 && Fibo[1]<240)
  {
  if(Fibo[2]>45 && Fibo[2]<65)
  {
  if(Fibo[4]>45 && Fibo[4]<65)
  {
  Print ("Brawo, Formacja MAY-00");
  licznik=9;
  formacja="MAY-00";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<165)
  {
  if(Fibo[1]>36 && Fibo[1]<40)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  Print ("Brawo, Formacja DAVIDVM 1");
  licznik=9;
  formacja="DAVIDVM 1";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>160 && Fibo[0]<365)
  {
  if(Fibo[1]>36 && Fibo[1]<40)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>60 && Fibo[3]<765)
  {
  Print ("Brawo, Formacja DAVIDVM 2");
  licznik=9;
  formacja="DAVIDVM 2";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>85 && Fibo[0]<120)
  {
  if(Fibo[1]>85 && Fibo[1]<120)
  {
  if(Fibo[2]>85 && Fibo[2]<120)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>60 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja SNORM");
  licznik=9;
  formacja="SNORM";
  miernik=1;
  return;
  }
  }
   if(Fibo[4]>Fibo[3])
  {
  if(Fibo[4]>60 && Fibo[4]<165)
  {
  Print ("Brawo, Formacja SNORM");
  licznik=9;
  formacja="SNORM";
  miernik=1;
  return;
  }
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>36 && Fibo[1]<265)
  {
  if(Fibo[2]>90 && Fibo[2]<110)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  Print ("Brawo, Formacja COL PORUCHIK");
  licznik=9;
  formacja="COL PORUCHIK";
  miernik=1;
  return;
  }
  }
   if(Fibo[4]>Fibo[3])
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja COL PORUCHIK");
  licznik=9;
  formacja="COL PORUCHIK";
  miernik=1;
  return;
  }
  }
  }
  }
  }*/
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>36 && Fibo[1]<55)
  {
  if(Fibo[2]>150 && Fibo[2]<265)
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  Print ("Brawo, Formacja SEA PONY");
  licznik=9;
  formacja="SEA PONY";
  miernik=1;
  return;
  }
  }
  }
  }
  /*if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>36 && Fibo[1]<54)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  Print ("Brawo, Formacja PARTIZAN");
  formacja="PARTIZAN";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>120 && Fibo[2]<265)
  {
  if(Fibo[3]>74 && Fibo[3]<90)
  {
  Print ("Brawo, Formacja TOTAL 1");
  formacja="TOTAL 1";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>160 && Fibo[2]<365)
  {
  if(Fibo[3]>110 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja TOTAL 2");
  formacja="TOTAL 2";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>24 && Fibo[0]<65)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>120 && Fibo[2]<265)
  {
  if(Fibo[4]>60 && Fibo[4]<90)
  {
  Print ("Brawo, Formacja TOTAL 3");
  formacja="TOTAL 3";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<65)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>120 && Fibo[2]<265)
  {
  if(Fibo[4]>110 && Fibo[4]<130)
  {
  Print ("Brawo, Formacja TOTAL 4");
  licznik=9;
  formacja="TOTAL 4";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>24 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<265)
  {
  if(Fibo[2]>120 && Fibo[2]<365)
  {
  if(Fibo[3]>60 && Fibo[3]<165)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>60 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja TOTAL");
  formacja="TOTAL";
  licznik=9;
  miernik=1;
  return;
  }
  }
   if(Fibo[4]>Fibo[3])
  {
  if(Fibo[4]>60 && Fibo[4]<165)
  {
  Print ("Brawo, Formacja TOTAL");
  formacja="TOTAL";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>110 && Fibo[1]<130)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2.1");
  formacja="PARTIZAN 2.1";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>110 && Fibo[1]<130)
  {
  if(Fibo[2]>210 && Fibo[2]<245)
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2.2");
  formacja="PARTIZAN 2.2";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>60 && Fibo[1]<165)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  if (Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>60 && Fibo[3]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2.3");
  formacja="PARTIZAN 2.3";
  licznik=9;
  miernik=1;
  return;
  }
  }
   if (Fibo[4]>Fibo[3])
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2.3");
  licznik=9;
  formacja="PARTIZAN 2.3";
  miernik=1;
  return;
  }
  }
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<365)
  {
  if(Fibo[1]>160 && Fibo[1]<165)
  {
  if(Fibo[2]>210 && Fibo[2]<240)
  {
  if(Fibo[4]>60 && Fibo[4]<365)
  {
  Print ("Brawo, Formacja PARTIZAN 2.4");
  licznik=9;
  formacja="PARTIZAN 2.4";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>60 && Fibo[1]<65)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja BG 1");
  licznik=9;
  formacja="BG 1";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>67 && Fibo[1]<72)
  {
  if(Fibo[2]>130 && Fibo[2]<145)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja BG 2");
  licznik=9;
  formacja="BG 2";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>74 && Fibo[1]<80)
  {
  if(Fibo[2]>110 && Fibo[2]<135)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja BG 4");
  licznik=9;
  formacja="BG 4";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>45 && Fibo[1]<55)
  {
  if(Fibo[2]>190 && Fibo[2]<210)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja BG 5");
  formacja="Formacja BG 5";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>36 && Fibo[1]<42)
  {
  if(Fibo[2]>260 && Fibo[2]<265)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 1");
  licznik=9;
  formacja="ABG 1";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>40 && Fibo[1]<47)
  {
  if(Fibo[2]>210 && Fibo[2]<240)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 2");
  licznik=9;
  formacja="ABG 2";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>47 && Fibo[1]<53)
  {
  if(Fibo[2]>190 && Fibo[2]<210)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 3");
  licznik=9;
  formacja="ABG 3";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>60 && Fibo[1]<65)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 4");
  licznik=9;
  formacja="ABG 4";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>66 && Fibo[1]<73)
  {
  if(Fibo[2]>135 && Fibo[2]<145)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 5");
  licznik=9;
  formacja="ABG 5";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>74 && Fibo[1]<80)
  {
  if(Fibo[2]>120 && Fibo[2]<135)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 6");
  licznik=9;
  formacja="ABG 6";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>80 && Fibo[1]<90)
  {
  if(Fibo[2]>110 && Fibo[2]<120)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 7");
  licznik=9;
  miernik=1;
  formacja="ABG 7";
  return;
  }
  }
  }
  }
  if(Fibo[0]>10 && Fibo[0]<90)
  {
  if(Fibo[1]>80 && Fibo[1]<90)
  {
  if(Fibo[2]>100 && Fibo[2]<120)
  {
  if(Fibo[3]>90 && Fibo[3]<110)
  {
  Print ("Brawo, Formacja ABG 8");
  licznik=9;
  formacja="ABG 8";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>45 && Fibo[0]<60)
  {
  if(Fibo[1]>110 && Fibo[1]<180)
  {
  if(Fibo[2]>60 && Fibo[2]<72)
  {
  if(Fibo[4]>40 && Fibo[4]<80)
  {
  Print ("Brawo, Formacja 121 BG");
  licznik=9;
  formacja="121 BG";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>60 && Fibo[0]<65)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>110 && Fibo[2]<165)
  {
  if(Fibo[3]>72 && Fibo[3]<80)
  {
  Print ("Brawo, Formacja NN GARTLEY");
  licznik=9;
  formacja="NN GARTLEY";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<52)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>160 && Fibo[2]<265)
  {
  if(Fibo[3]>80 && Fibo[3]<90)
  {
  Print ("Brawo, Formacja NN BAT");
  licznik=9;
  formacja="NN BAT";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<42)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>190 && Fibo[2]<425)
  {
  if(Fibo[3]>100 && Fibo[3]<120)
  {
  Print ("Brawo, Formacja NN ALT BAT");
  licznik=9;
  formacja="NN ALT BAT";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<65)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>210 && Fibo[2]<425)
  {
  if(Fibo[3]>160 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja NN CRAB");
  licznik=9;
  formacja="NN CRAB";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>80 && Fibo[0]<90)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>260 && Fibo[2]<425)
  {
  if(Fibo[3]>160 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja NN DEEP CRAB");
  licznik=9;
  formacja="NN DEEP CRAB";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>60 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>160 && Fibo[2]<165)
  {
  if(Fibo[4]>110 && Fibo[4]<130)
  {
  Print ("Brawo, Formacja NN A GARTLEY");
  licznik=9;
  formacja="NN A GARTLEY";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<65)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>190 && Fibo[2]<265)
  {
  if(Fibo[4]>100 && Fibo[4]<120)
  {
  Print ("Brawo, Formacja NN A BAT");
  licznik=9;
  formacja="NN A BAT";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>20 && Fibo[0]<52)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>190 && Fibo[2]<265)
  {
  if(Fibo[4]>100 && Fibo[4]<120)
  {
  Print ("Brawo, Formacja NN A ALT BAT");
  licznik=9;
  formacja="NN A ALT BAT";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<65)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>110 && Fibo[2]<135)
  {
  if(Fibo[4]>60 && Fibo[4]<80)
  {
  Print ("Brawo, Formacja NN A BUTTERFLY");
  licznik=9;
  formacja="NN A BUTTERFLY";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>20 && Fibo[0]<50)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>110 && Fibo[2]<265)
  {
  if(Fibo[4]>60 && Fibo[4]<65)
  {
  Print ("Brawo, Formacja NN A CRAB");
  licznik=9;
  formacja="NN A CRAB";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>20 && Fibo[0]<40)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>100 && Fibo[2]<120)
  {
  if(Fibo[4]>60 && Fibo[4]<65)
  {
  Print ("Brawo, Formacja NN A DEEP CRAB");
  licznik=9;
  formacja="NN A DEEP CRAB";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>45 && Fibo[0]<52)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>110 && Fibo[2]<265)
  {
  if(Fibo[3]>75 && Fibo[3]<82)
  {
  Print ("Brawo, Formacja NN LEO");
  formacja="NN LEO";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<90)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>190 && Fibo[2]<210)
  {
  if(Fibo[4]>110 && Fibo[4]<130)
  {
  Print ("Brawo, Formacja NN A LEO");
  licznik=9;
  formacja="NN A LEO";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>120 && Fibo[2]<265)
  {
  if(Fibo[3]>75 && Fibo[3]<90)
  {
  Print ("Brawo, Formacja NN TOTAL 1");
  licznik=9;
  formacja="NN TOTAL 1";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<90)
  {
  if(Fibo[2]>160 && Fibo[2]<425)
  {
  if(Fibo[3]>110 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja NN TOTAL 2");
  licznik=9;
  formacja="NN TOTAL 2";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>20 && Fibo[0]<65)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>120 && Fibo[2]<265)
  {
  if(Fibo[4]>60 && Fibo[4]<90)
  {
  Print ("Brawo, Formacja NN TOTAL 3");
  licznik=9;
  formacja="NN TOTAL 3";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>36 && Fibo[0]<80)
  {
  if(Fibo[1]>110 && Fibo[1]<265)
  {
  if(Fibo[2]>160 && Fibo[2]<265)
  {
  if(Fibo[4]>110 && Fibo[4]<130)
  {
  Print ("Brawo, Formacja NN TOTAL 4");
  licznik=9;
  formacja="NN TOTAL 4";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>20 && Fibo[0]<80)
  {
  if(Fibo[1]>36 && Fibo[1]<265)
  {
  if(Fibo[2]>110 && Fibo[2]<425)
  {
  if(Fibo[3]>Fibo[4])
  {
  if(Fibo[3]>60 && Fibo[3]<165)
  {
  Print ("Brawo, Formacja NN TOTAL ***");
  licznik=9;
  formacja="NN TOTAL ***";
  miernik=1;
  return;
  }
  }
   if(Fibo[4]>Fibo[3])
  {
  if(Fibo[4]>60 && Fibo[4]<165)
  {
  Print ("Brawo, Formacja NN TOTAL ***");
  licznik=9;
  formacja="NN TOTAL ***";
  miernik=1;
  return;
  }
  }
  }
  }
  }
  if(Fibo[0]>130 && Fibo[0]<265)
  {
  if(Fibo[1]>20 && Fibo[1]<52)
  {
  if(Fibo[2]>110 && Fibo[2]<210)
  {
  if(Fibo[3]>110 && Fibo[3]<265)
  {
  Print ("Brawo, Formacja NN BL SWAN");
  licznik=9;
  formacja="NN BL SWAN";
  miernik=1;
  return;
  }
  }
  }
  }
  if(Fibo[0]>30 && Fibo[0]<75)
  {
  if(Fibo[1]>190 && Fibo[1]<425)
  {
  if(Fibo[2]>45 && Fibo[2]<90)
  {
  if(Fibo[4]>36 && Fibo[4]<90)
  {
  Print ("Brawo, Formacja NN WH SWAN");
  formacja="NN WH SWAN";
  licznik=9;
  miernik=1;
  return;
  }
  }
  }
  }*/
  if (miernik<1)
  {
  Print ("Przykro mi, ale nie znalazlem formacji harmonicznej :(");
  licznik=9;
  return;
  }
  RefreshRates();
}
 
  if (licznik>8)
  {
   ObjectDelete(current_chart_id,"Trojkat1");
   ObjectDelete(current_chart_id,"Trojkat2");
   ObjectDelete(current_chart_id,"Trojkat3");
   ObjectDelete(current_chart_id,"Trojkat4");
   ObjectDelete(current_chart_id,"Trojkat5");
   Sleep(50);
   licznik=0;
   kontroler=0;
   wskaznikHIGH=0;
   wskaznikLOW=0;
   wskaznikhistorycznyHIGH=0;
   wskaznikhistorycznyLOW=0;
   LicznikTrojkatow=0;
   datapunktubuy=datakontrolna;
   datapunktusell=datakontrolna;
 datapoczatku=datakontrolna;
 DateNew2=datakontrolna;
 DateCurrent2=datakontrolna;
 DateNew=datakontrolna;
 DateCurrent=datakontrolna;
HighestHighNew=0;
LowestLowNew=0;
 HighestHighCurrent=0;
LowestLowCurrent=0;
cenapunktubuy=0;
cenapunktusell=0;
indexhigh=0;
indexlow=0;
n=0;
trojkat1czas[0]=datakontrolna;
trojkat1czas[1]=datakontrolna;
trojkat1czas[2]=datakontrolna;
trojkat2czas[0]=datakontrolna;
trojkat2czas[1]=datakontrolna;
trojkat2czas[2]=datakontrolna;
trojkat1cena[0]=0;
trojkat1cena[1]=0;
trojkat1cena[2]=0;
trojkat2cena[0]=0;
trojkat2cena[1]=0;
trojkat2cena[2]=0;
z=0;
DateNewHist=datakontrolna;
DateNew2Hist=datakontrolna;
DateCurrentHist=datakontrolna;
DateCurrent2Hist=datakontrolna;
HighestHighNewHist=0;
HighestHighCurrentHist=0;
LowestLowNewHist=0;
LowestLowCurrentHist=0;
kontrolerhist=0;
pierwszytrojkat=0;
poczatek=0;
ostatni=0;
Fibo[0]=0;
Fibo[1]=0;
Fibo[2]=0;
Fibo[3]=0;
Fibo[4]=0;
miernik=0;
RefreshRates();
return;
  }
}

//+------------------------------------------------------------------
